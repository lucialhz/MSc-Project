\section{Conclusion}

The objective of this project was to investigate secure software execution in embedded systems and apply this knowledge towards a proposed method of providing audit records of control-flow.

In order to achieve these objectives, it was first important to understand the principles of control-flow: how instructions within an application transition into one another, how we can model these transitions using control-flow graphs (CFG) and how that if the instruction execution diverts away from following the CFG for a particular application this represents a violation of control-flow integrity (CFI), an important principal when considering secure software execution. Attacks on secure software execution were identified and examined as were the elements of execution flow which are vulnerable to manipulation. A literature review was carried out on the subject of secure software execution as well as software-hardware binding, as the two concepts meet in that they require close control\slash monitoring of software execution, and that by utilising dedicated cryptographic keys in ensuring secure software execution it is possible to leverage the mechanisms to provide software-hardware binding. Leading solutions providing static attestation and CFI attestation\slash protection were analysed and assessed against a set of defined requirements. Finally a proposed solution, with the goal of providing audit records of control-flow, was described.

The solution presented was defined after the introduction and literature review and inspired by the solutions identified in the comparison chapter. It was decided that the solution would be software-based and leverage the security features provided by TrustZone functionality of the ARMv8-M architecture to removed the requirement for additional hardware. The solution consists of several phases: performing analysis on the compiled binary to produce a CFG (for use as a comparison when audit records are referred to a later point), undertaking an instrumentation phase where instructions within the binary are replaced with ones facilitating control-flow monitoring, provisioning the binary to the device, performing an initial static attestation report on the ``normal-world'' and ``secure-world'' memory, before sampling the control-flow history of the application and storing it along with important operating variables in signed and hash-chained files.

A security analysis of the proposed solution found that while a software-based method leveraging ARM TrustZone would provide a method of auditing control-flow, a hardware-based solution would offer many more advantages, such as removing execution overhead from the primary processor and enabling the monitoring at an individual instruction level granularity. The analysis also found that the use of offline methods for monitoring control-flow were vulnerable to several attacks such as replay and proxy-based attacks, however this could be mitigated against through the combined use of tamper resistant real time clocks and digital signatures.

Further work could include implementing the proposed solution, testing the overhead introduced by the solution and implementing a similar solution using hardware (for example using an FPGA with a softcore processor).

